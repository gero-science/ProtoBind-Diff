run_type = "staged_learning"
device = "cuda:0"
tb_logdir = "tb_logs"
json_out_config = "staged_learning.json"
[[stage]]
chkpt_file = "staged_learning.chkpt"
termination = "simple"
max_score = 0.99
min_steps = 25
max_steps = 1000

[stage.scoring]
type = "geometric_mean"
[[stage.scoring.component]]

[stage.scoring.component.MolecularWeight]
[[stage.scoring.component.MolecularWeight.endpoint]]
name = "MolWt"
weight = 2

[stage.scoring.component.MolecularWeight.endpoint.transform]
type = "double_sigmoid"
high = 703.88
low = 203.46
coef_div = 9.0
coef_si = 20.0
coef_se = 20.0
[[stage.scoring.component]]

[stage.scoring.component.SlogP]
[[stage.scoring.component.SlogP.endpoint]]
name = "MolLogP"
weight = 2

[stage.scoring.component.SlogP.endpoint.transform]
type = "double_sigmoid"
high = 8.41
low = 2.43
coef_div = 9.0
coef_si = 20.0
coef_se = 20.0
[[stage.scoring.component]]

[stage.scoring.component.NumRotBond]
[[stage.scoring.component.NumRotBond.endpoint]]
name = "NumRotatableBonds"
weight = 1

[stage.scoring.component.NumRotBond.endpoint.transform]
type = "double_sigmoid"
high = 14.14
low = -1.11
coef_div = 9.0
coef_si = 20.0
coef_se = 20.0
[[stage.scoring.component]]

[stage.scoring.component.TPSA]
[[stage.scoring.component.TPSA.endpoint]]
name = "CalcTPSA"
weight = 1

[stage.scoring.component.TPSA.endpoint.transform]
type = "double_sigmoid"
high = 135.18
low = -4.67
coef_div = 9.0
coef_si = 20.0
coef_se = 20.0
[[stage.scoring.component]]

[stage.scoring.component.NumRings]
[[stage.scoring.component.NumRings.endpoint]]
name = "RingCount"
weight = 2

[stage.scoring.component.NumRings.endpoint.transform]
type = "double_sigmoid"
high = 6.93
low = 2.02
coef_div = 15.0
coef_si = 30.0
coef_se = 30.0
[[stage.scoring.component]]

[stage.scoring.component.NumHeavyAtoms]
[[stage.scoring.component.NumHeavyAtoms.endpoint]]
name = "GetNumHeavyAtoms"
weight = 1

[stage.scoring.component.NumHeavyAtoms.endpoint.transform]
type = "double_sigmoid"
high = 50.5
low = 14.85
coef_div = 9.0
coef_si = 20.0
coef_se = 20.0
[[stage.scoring.component]]

[stage.scoring.component.NumAromaticRings]
[[stage.scoring.component.NumAromaticRings.endpoint]]
name = "CalcNumAromaticRings"
weight = 1

[stage.scoring.component.NumAromaticRings.endpoint.transform]
type = "double_sigmoid"
high = 4.97
low = 1.26
coef_div = 9.0
coef_si = 40.0
coef_se = 20.0
[[stage.scoring.component]]

[stage.scoring.component.Csp3]
[[stage.scoring.component.Csp3.endpoint]]
name = "CalcFractionCSP3"
weight = 1

[stage.scoring.component.Csp3.endpoint.transform]
type = "double_sigmoid"
high = 0.65
low = -0.05
coef_div = 2.0
coef_si = 20.0
coef_se = 20.0
[[stage.scoring.component]]

[stage.scoring.component.HBondAcceptors]
[[stage.scoring.component.HBondAcceptors.endpoint]]
name = "NumHAcceptors"
weight = 1

[stage.scoring.component.HBondAcceptors.endpoint.transform]
type = "double_sigmoid"
high = 8.18
low = 0.58
coef_div = 9.0
coef_si = 20.0
coef_se = 20.0
[[stage.scoring.component]]

[stage.scoring.component.HBondDonors]
[[stage.scoring.component.HBondDonors.endpoint]]
name = "NumHDonors"
weight = 1

[stage.scoring.component.HBondDonors.endpoint.transform]
type = "double_sigmoid"
high = 4.16
low = -0.36
coef_div = 9.0
coef_si = 20.0
coef_se = 20.0

[parameters]
summary_csv_prefix = "staged_learning"
use_checkpoint = false
purge_memories = false
prior_file = "/data/avchaciov/libspython/reinvent/priors/reinvent.prior"
agent_file = "/data/avchaciov/libspython/reinvent/priors/reinvent.prior"
batch_size = 64
unique_sequences = true
randomize_smiles = false

[learning_strategy]
type = "dap"
sigma = 128
rate = 0.0005

[diversity_filter]
type = "PenalizeSameSmiles"
bucket_size = 25
minscore = 0.4
minsimilarity = 0.4
penalty_multiplier = 0.5
